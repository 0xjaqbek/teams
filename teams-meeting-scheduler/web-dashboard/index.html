<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Automatyzacji Spotkań Teams - Wersja Lokalna</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-robot"></i>
                    <h1>Teams Auto-Join - Wersja Lokalna</h1>
                    <small>Bez Firebase - wszystko działa lokalnie!</small>
                </div>
                <div class="local-version-badge">
                    <i class="fas fa-desktop"></i>
                    <span>Wersja Lokalna</span>
                </div>
                <div class="status-badge" id="statusBadge">
                    <i class="fas fa-circle"></i>
                    <span>Gotowy</span>
                </div>
            </div>
        </header>

        <!-- Main Dashboard -->
        <main class="main-content">
            <!-- Quick Actions -->
            <section class="quick-actions">
                <h2>Szybkie akcje</h2>
                <div class="action-grid">
                    <button class="action-btn primary" onclick="downloadConfigFile()">
                        <i class="fas fa-download"></i>
                        <span>Pobierz plik konfiguracyjny</span>
                        <small>Tworzy plik user-credentials.json gotowy do użycia</small>
                    </button>
                    <button class="action-btn tertiary" onclick="openMeetingScheduler()">
                        <i class="fas fa-calendar-plus"></i>
                        <span>Zaplanuj spotkanie</span>
                        <small>Dodaj nowe spotkanie Teams do automatycznego dołączenia</small>
                    </button>
                    <button class="action-btn success" onclick="openSimpleSettings()">
                        <i class="fas fa-user-cog"></i>
                        <span>Dane logowania Teams</span>
                        <small>Dodaj swoje dane Microsoft Teams (przechowywane lokalnie)</small>
                    </button>
                    <button class="action-btn quaternary" onclick="viewLogs()">
                        <i class="fas fa-file-text"></i>
                        <span>Historia aktywności</span>
                        <small>Zobacz logi z automatycznego dołączania do spotkań</small>
                    </button>
                    <button class="action-btn info" onclick="openModal('instructionsModal')">
                        <i class="fas fa-question-circle"></i>
                        <span>Instrukcja dla początkujących</span>
                        <small>Szczegółowy przewodnik krok po kroku z obrazkami</small>
                    </button>
                </div>
            </section>

            <!-- Meeting Management -->
            <section class="meeting-section">
                <div class="section-header">
                    <h2>Zaplanowane spotkania</h2>
                    <button class="btn-icon" onclick="refreshMeetings()" title="Odśwież listę spotkań">
                        <i class="fas fa-refresh"></i>
                    </button>
                </div>
                <div class="meetings-container" id="meetingsContainer">
                    <!-- Meetings will be loaded here -->
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>Ładowanie spotkań...</span>
                    </div>
                </div>
            </section>

            <!-- Statistics -->
            <section class="stats-section">
                <h2>Statystyki automatyzacji</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-check-circle"></i>
                        <div class="stat-content">
                            <span class="stat-number" id="successCount">0</span>
                            <span class="stat-label">Udane dołączenia</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-clock"></i>
                        <div class="stat-content">
                            <span class="stat-number" id="pendingCount">0</span>
                            <span class="stat-label">Oczekujące spotkania</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div class="stat-content">
                            <span class="stat-number" id="failedCount">0</span>
                            <span class="stat-label">Nieudane próby</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-calendar"></i>
                        <div class="stat-content">
                            <span class="stat-number" id="todayCount">0</span>
                            <span class="stat-label">Dzisiejsze spotkania</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Recent Activity -->
            <section class="activity-section">
                <h2>Ostatnia aktywność</h2>
                <div class="activity-feed" id="activityFeed">
                    <!-- Activity items will be loaded here -->
                </div>
            </section>
        </main>

        <!-- Modals -->
        <!-- Schedule Meeting Modal -->
        <div class="modal" id="scheduleMeetingModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Zaplanuj nowe spotkanie</h3>
                    <button class="modal-close" onclick="closeModal('scheduleMeetingModal')">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <form class="modal-body" id="meetingForm">
                    <div class="form-group">
                        <label>Link do spotkania Teams</label>
                        <input type="url" id="meetingLink" placeholder="https://teams.microsoft.com/l/meetup-join/..." required>
                    </div>
                    <div class="teams-credentials-info">
                        <i class="fas fa-info-circle"></i>
                        <span>Dane logowania do Teams zostaną automatycznie wczytane z Twojego profilu</span>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Data</label>
                            <input type="date" id="meetingDate" required>
                        </div>
                        <div class="form-group">
                            <label>Godzina</label>
                            <input type="time" id="meetingTime" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Maksymalne próby</label>
                            <input type="number" id="maxRetries" value="3" min="1" max="10">
                        </div>
                        <div class="form-group">
                            <label>Automatyczne dołączenie</label>
                            <select id="autoJoin">
                                <option value="true">Włączone</option>
                                <option value="false">Wyłączone</option>
                            </select>
                        </div>
                    </div>
                </form>
                <div class="modal-footer">
                    <button class="btn secondary" onclick="closeModal('scheduleMeetingModal')">Anuluj</button>
                    <button class="btn primary" onclick="scheduleMeeting()">Zaplanuj spotkanie</button>
                </div>
            </div>
        </div>

        <!-- Logs Modal -->
        <div class="modal" id="logsModal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h3>Logi automatyzacji</h3>
                    <button class="modal-close" onclick="closeModal('logsModal')">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="logs-container" id="logsContainer">
                        <div class="log-loading">
                            <i class="fas fa-spinner fa-spin"></i>
                            <span>Ładowanie logów...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Simple Local Settings Modal -->
        <div class="modal" id="simpleSettingsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Dane logowania Microsoft Teams</h3>
                    <button class="modal-close" onclick="closeModal('simpleSettingsModal')">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="local-info-banner">
                        <i class="fas fa-shield-alt"></i>
                        <div>
                            <strong>Bezpieczeństwo danych</strong>
                            <p>Wszystkie dane są przechowywane tylko lokalnie na Twoim komputerze. Żadne informacje nie są wysyłane do internetu.</p>
                        </div>
                    </div>

                    <form id="localSettingsForm">
                        <div class="form-group">
                            <label><i class="fas fa-user"></i> Twoje imię</label>
                            <input type="text" id="localDisplayName" placeholder="np. Jan Kowalski" required>
                            <small>Będzie używane w logach automatyzacji</small>
                        </div>

                        <div class="form-group">
                            <label><i class="fas fa-envelope"></i> Email Microsoft Teams</label>
                            <input type="email" id="localTeamsEmail" placeholder="jan.kowalski@firma.com" required>
                            <small>Email którego używasz do logowania w Teams</small>
                        </div>

                        <div class="form-group">
                            <label><i class="fas fa-lock"></i> Hasło Microsoft Teams</label>
                            <input type="password" id="localTeamsPassword" placeholder="Twoje hasło Teams" required>
                            <small>Hasło zostanie zaszyfrowane przed zapisaniem</small>
                        </div>

                        <div class="form-group">
                            <label><i class="fas fa-microphone"></i> Google Speech API Key (opcjonalne)</label>
                            <input type="text" id="localGoogleApiKey" placeholder="AIzaSy...">
                            <small>Tylko jeśli chcesz transkrypcję na żywo. Zostaw puste jeśli nie masz.</small>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" onclick="closeModal('simpleSettingsModal')">Anuluj</button>
                    <button class="btn primary" onclick="saveLocalSettings()">Zapisz dane</button>
                </div>
            </div>
        </div>

        <!-- Profile Settings Modal -->
        <div class="modal" id="profileModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Ustawienia profilu</h3>
                    <button class="modal-close" onclick="closeModal('profileModal')">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="profile-section">
                        <h4><i class="fas fa-user"></i> Informacje o koncie</h4>
                        <div class="profile-info">
                            <div class="form-group">
                                <label>Nazwa wyświetlana</label>
                                <input type="text" id="profileDisplayName" placeholder="Twoje imię">
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="profileEmail" readonly>
                            </div>
                        </div>
                    </div>

                    <div class="profile-section">
                        <h4><i class="fas fa-shield-alt"></i> Dane logowania Teams</h4>
                        <div class="credentials-info">
                            <p><i class="fas fa-info-circle"></i> Te dane są szyfrowane i przechowywane bezpiecznie</p>
                        </div>
                        <div class="form-group">
                            <label>Email Teams</label>
                            <input type="email" id="profileTeamsEmail" placeholder="twoj.email@firma.com">
                        </div>
                        <div class="form-group">
                            <label>Hasło Teams</label>
                            <input type="password" id="profileTeamsPassword" placeholder="Twoje hasło Teams">
                            <small>Hasło zostanie zaszyfrowane przed zapisaniem</small>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" onclick="closeModal('profileModal')">Anuluj</button>
                    <button class="btn primary" onclick="saveProfile()">Zapisz ustawienia</button>
                </div>
            </div>
        </div>

        <!-- Instructions Modal -->
        <div class="modal" id="instructionsModal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h3>Instrukcja obsługi - krok po kroku</h3>
                    <button class="modal-close" onclick="closeModal('instructionsModal')">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="instructions-content">
                        <div class="local-version-info">
                            <h4><i class="fas fa-desktop"></i> Instrukcja dla wersji lokalnej</h4>
                            <p>Ta wersja nie wymaga kont Firebase ani Google Cloud - wszystko działa lokalnie na Twoim komputerze!</p>
                        </div>

                        <div class="instruction-step">
                            <h4><i class="fas fa-download"></i> Krok 1: Zainstaluj Node.js</h4>
                            <div class="step-details">
                                <p><strong>Co to jest Node.js?</strong> To program potrzebny do uruchomienia automatyzacji.</p>
                                <ol>
                                    <li>Kliknij tutaj: <a href="https://nodejs.org" target="_blank" class="download-link">Pobierz Node.js</a></li>
                                    <li>Na stronie kliknij duży zielony przycisk z napisem "LTS" (zalecane)</li>
                                    <li>Poczekaj aż plik się pobierze (około 30MB)</li>
                                    <li>Kliknij dwukrotnie na pobrany plik i postępuj zgodnie z instrukcjami</li>
                                    <li><strong>Sprawdź instalację:</strong> Naciśnij Win+R, wpisz <code>cmd</code>, naciśnij Enter</li>
                                    <li>W czarnym oknie wpisz: <code>node --version</code> i naciśnij Enter</li>
                                    <li>Jeśli zobaczysz numer wersji (np. v18.17.0) - instalacja udana! ✅</li>
                                </ol>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <h4><i class="fas fa-chrome"></i> Krok 2: Sprawdź Google Chrome</h4>
                            <div class="step-details">
                                <p><strong>Dlaczego Chrome?</strong> Automatyzacja steruje przeglądarką, aby dołączyć do Teams.</p>
                                <ol>
                                    <li>Otwórz Google Chrome (jeśli nie masz, pobierz z <a href="https://www.google.com/chrome" target="_blank">google.com/chrome</a>)</li>
                                    <li><strong>Ważne:</strong> Zaloguj się do Microsoft Teams w Chrome</li>
                                    <li>Wejdź na <a href="https://teams.microsoft.com" target="_blank">teams.microsoft.com</a> i sprawdź czy możesz się zalogować</li>
                                    <li>Jeśli Teams działa w przeglądarce - wszystko gotowe! ✅</li>
                                </ol>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <h4><i class="fas fa-user-cog"></i> Krok 3: Wprowadź swoje dane</h4>
                            <div class="step-details">
                                <p><strong>Co wprowadzić?</strong> Dane do logowania w Microsoft Teams.</p>
                                <ol>
                                    <li>Kliknij przycisk <strong>"Dane logowania Teams"</strong> w tym oknie</li>
                                    <li>Wprowadź swoje imię (np. "Jan Kowalski")</li>
                                    <li>Wprowadź email używany w Teams (np. "jan.kowalski@firma.com")</li>
                                    <li>Wprowadź hasło do Teams</li>
                                    <li>Kliknij "Zapisz dane"</li>
                                    <li><strong>Bezpieczeństwo:</strong> Dane są szyfrowane i przechowywane tylko na Twoim komputerze</li>
                                </ol>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <h4><i class="fas fa-calendar-plus"></i> Krok 4: Dodaj spotkanie</h4>
                            <div class="step-details">
                                <p><strong>Jak dodać spotkanie?</strong> Skopiuj link z Teams i ustaw czas.</p>
                                <ol>
                                    <li>Kliknij <strong>"Zaplanuj spotkanie"</strong></li>
                                    <li>Skopiuj link do spotkania z Teams (zaczyna się od https://teams.microsoft.com/l/meetup-join/...)</li>
                                    <li>Wklej link w pole "Link do spotkania Teams"</li>
                                    <li>Ustaw datę i godzinę spotkania</li>
                                    <li>Kliknij "Zaplanuj spotkanie"</li>
                                </ol>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <h4><i class="fas fa-download"></i> Krok 5: Pobierz plik konfiguracyjny</h4>
                            <div class="step-details">
                                <p><strong>Co to za plik?</strong> Zawiera wszystkie Twoje ustawienia w formacie zrozumiałym dla automatyzacji.</p>
                                <ol>
                                    <li>Kliknij <strong>"Pobierz plik konfiguracyjny"</strong></li>
                                    <li>Plik "user-credentials.json" zostanie pobrany do folderu Pobrane</li>
                                    <li>Skopiuj ten plik do folderu "meeting-joiner" w pobranym projekcie</li>
                                    <li>Sprawdź czy plik jest w odpowiednim miejscu</li>
                                </ol>
                            </div>
                        </div>

                        <div class="instruction-step">
                            <h4><i class="fas fa-terminal"></i> Krok 6: Uruchom automatyzację</h4>
                            <div class="step-details">
                                <p><strong>Jak uruchomić?</strong> Szczegółowe instrukcje otwierania terminala.</p>
                                <div class="terminal-methods">
                                    <div class="method">
                                        <h5>Metoda 1: Win + R</h5>
                                        <ol>
                                            <li>Naciśnij <kbd>Win</kbd> + <kbd>R</kbd></li>
                                            <li>Wpisz: <code>cmd</code></li>
                                            <li>Naciśnij Enter</li>
                                            <li>Wpisz: <code>cd "ścieżka\\do\\meeting-joiner"</code></li>
                                            <li>Naciśnij Enter</li>
                                            <li>Wpisz: <code>node local-joiner.js schedule</code></li>
                                            <li>Naciśnij Enter</li>
                                        </ol>
                                    </div>
                                    <div class="method">
                                        <h5>Metoda 2: Z folderu (łatwiejsza)</h5>
                                        <ol>
                                            <li>Otwórz folder "meeting-joiner"</li>
                                            <li>Kliknij w pasek adresu (tam gdzie jest ścieżka)</li>
                                            <li>Usuń wszystko i wpisz: <code>cmd</code></li>
                                            <li>Naciśnij Enter</li>
                                            <li>Wpisz: <code>node local-joiner.js schedule</code></li>
                                            <li>Naciśnij Enter</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="instruction-step success">
                            <h4><i class="fas fa-check-circle"></i> Gotowe! Automatyzacja działa</h4>
                            <div class="step-details">
                                <p><strong>Co się dzieje teraz?</strong></p>
                                <ul>
                                    <li>System monitoruje zaplanowane spotkania</li>
                                    <li>W odpowiednim czasie automatycznie otwiera Chrome</li>
                                    <li>Loguje się do Teams i dołącza do spotkania</li>
                                    <li>Wszystkie logi są zapisywane lokalnie</li>
                                </ul>
                                <div class="success-message">
                                    <p><strong>Jeśli zobaczysz komunikat "Monitoring scheduled meetings..." - wszystko działa poprawnie!</strong></p>
                                </div>
                            </div>
                        </div>

                        <div class="troubleshooting-section">
                            <h4><i class="fas fa-question-circle"></i> Najczęstsze problemy</h4>
                            <div class="faq-mini">
                                <div class="faq-item-mini">
                                    <strong>❌ "node nie jest rozpoznany"</strong>
                                    <p>Node.js nie jest zainstalowany lub trzeba uruchomić nowy terminal</p>
                                </div>
                                <div class="faq-item-mini">
                                    <strong>❌ "Cannot find module"</strong>
                                    <p>Uruchom <code>npm install</code> w folderze meeting-joiner</p>
                                </div>
                                <div class="faq-item-mini">
                                    <strong>❌ "Access denied"</strong>
                                    <p>Uruchom terminal jako administrator (prawy klick → "Uruchom jako administrator")</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn primary" onclick="closeModal('instructionsModal')">Rozumiem</button>
                </div>
            </div>
        </div>

        <!-- Command Terminal -->
        <div class="terminal" id="terminal">
            <div class="terminal-header">
                <span>Terminal automatyzacji</span>
                <div class="terminal-controls">
                    <button onclick="clearTerminal()"><i class="fas fa-trash"></i></button>
                    <button onclick="toggleTerminal()"><i class="fas fa-minus"></i></button>
                </div>
            </div>
            <div class="terminal-body" id="terminalBody">
                <div class="terminal-line">
                    <span class="prompt">teams-automation$</span>
                    <span class="output">Gotowy do poleceń...</span>
                </div>
            </div>
        </div>

        <!-- Floating Action Button -->
        <button class="fab" onclick="toggleTerminal()" title="Przełącz terminal">
            <i class="fas fa-terminal"></i>
        </button>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="local-script.js"></script>
</body>
</html>